<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSFlow: Dual Supervision and Step-Aware Architecture for One-Step Flow Matching Speech Synthesis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.95;
            max-width: 800px;
            margin: 0 auto;
        }

        .content {
            padding: 50px 40px;
        }

        section {
            margin-bottom: 60px;
        }

        h2 {
            font-size: 2em;
            margin-bottom: 25px;
            color: #667eea;
            border-left: 5px solid #667eea;
            padding-left: 20px;
        }

        h3 {
            font-size: 1.4em;
            margin: 30px 0 20px 0;
            color: #764ba2;
        }

        .abstract {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            border-radius: 15px;
            font-size: 1.05em;
            text-align: justify;
            line-height: 1.8;
        }

        .highlight {
            color: #667eea;
            font-weight: 600;
        }

        .framework-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .framework-container img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .framework-container iframe {
            width: 100%;
            height: 600px;
            border: none;
            border-radius: 10px;
        }

        .pdf-link {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 25px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 25px;
            transition: all 0.3s;
        }

        .pdf-link:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .caption {
            margin-top: 20px;
            font-size: 0.95em;
            color: #666;
            line-height: 1.7;
            text-align: left;
        }

        .demo-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        th {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        .model-name {
            font-weight: 600;
            color: #667eea;
        }

        .stepflow-row {
            background: #e7f3ff !important;
        }

        .stepflow-row .model-name {
            color: #764ba2;
            font-size: 1.05em;
        }

        audio {
            width: 100%;
            max-width: 250px;
            height: 40px;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-best {
            background: #d4edda;
            color: #155724;
        }

        .badge-fast {
            background: #d1ecf1;
            color: #0c5460;
        }

        .badge-slow {
            background: #f8d7da;
            color: #721c24;
        }

        .metrics-table {
            text-align: center;
        }

        .metrics-table td {
            text-align: center;
        }

        .best-score {
            font-weight: 700;
            color: #28a745;
        }

        .info-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 0.95em;
        }

        .citation {
            background: #2d3748;
            color: #e2e8f0;
            padding: 25px;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            line-height: 1.6;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .comparison-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }

        .comparison-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .comparison-card h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .audio-label {
            font-size: 0.9em;
            color: #666;
            margin: 10px 0 5px 0;
            font-weight: 500;
        }

        footer {
            background: #f8f9fa;
            padding: 30px 40px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            header {
                padding: 40px 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            .content {
                padding: 30px 20px;
            }

            h2 {
                font-size: 1.5em;
            }

            table {
                font-size: 0.9em;
            }

            th, td {
                padding: 10px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>StepFlow</h1>
            <p class="subtitle">Dual Supervision and Step-Aware Architecture for One-Step Flow Matching Speech Synthesis</p>
        </header>

        <div class="content">
            <!-- Abstract -->
            <section>
                <h2>Abstract</h2>
                <div class="abstract">
Flow-matching models have enabled high-quality text-to-speech synthesis, but their iterative sampling process during inference incurs substantial computational cost. Although distillation is widely used to reduce the number of inference steps, existing methods often suffer from process variance due to endpoint error accumulation. Moreover, directly reusing continuous-time architectures for discrete, fixed-step generation introduces structural parameter inefficiencies.
To address these challenges, we introduce DSFlow, a modular distillation framework for few-step and one-step synthesis. DSFlow reformulates generation as a discrete prediction task and explicitly adapts the student model to the target inference regime. It improves training stability through a dual supervision strategy that combines endpoint matching with deterministic mean-velocity alignment, enforcing consistent generation trajectories across inference steps. In addition, DSFlow improves parameter efficiency by replacing continuous-time timestep conditioning with lightweight step-aware tokens, aligning model capacity with the significantly reduced timestep space of the discrete task.
Extensive experiments across diverse flow-based text-to-speech architectures demonstrate that DSFlow consistently outperforms standard distillation approaches, achieving strong few-step and one-step synthesis quality while reducing model parameters and inference cost.                </div>
            </section>

            <!-- Framework -->
            <section>
                <h2>Framework Architecture</h2>
                <div class="framework-container">
                    <img src="assets/images/Framework_final.jpg" alt="StepFlow Framework Architecture">
                    <div class="caption">
                        <strong>Figure 1. Overview of the StepFlow framework.</strong>
Overview of the DSFlow framework. The left and center panels show the transition from a DiT block with adaLN-Zero conditioning to the proposed step-aware architecture, where the heavy time-modulation network is replaced by lightweight step-aware tokens. The right panel illustrates dual supervision, which combines endpoint matching with deterministic mean velocity alignment to guide the student along the teacherâ€™s mean trajectory (green vectors), improving process consistency over endpoint-only distillation without additional Jacobian computation.                    </div>
                </div>
            </section>

            <!-- Audio Demos -->
            <section>
                <h2>Audio Demonstrations</h2>
                <div class="info-box">
                    ðŸ“¢ All samples are generated in a <strong>zero-shot manner</strong> using the model trained on the 95K-hour Emilia dataset. Listen to the quality difference between multi-step and single-step synthesis!
                </div>

                <!-- Main Comparison -->
                <div class="demo-section">
                    <h3>1. Quality Comparison: 10-Step Teacher vs 1-Step StepFlow</h3>
                    <p style="margin-bottom: 20px;">Compare our 1-step synthesis against the 10-step teacher model and naive endpoint distillation.</p>
                    <table>
                        <thead>
                            <tr>
                                <th>Model</th>
                                <th>Steps</th>
                                <th>English Sample</th>
                                <th>Mandarin Sample</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="model-name">Teacher (StepTTS)</span><span class="badge badge-slow">10 steps</span></td>
                                <td style="text-align: center;">10</td>
                                <td><audio controls><source src="audio/teacher_en_1.wav" type="audio/wav">Your browser does not support audio.</audio></td>
                                <td><audio controls><source src="audio/teacher_zh_1.wav" type="audio/wav">Your browser does not support audio.</audio></td>
                            </tr>
                            <tr class="stepflow-row">
                                <td><span class="model-name">StepFlow (Ours)</span><span class="badge badge-best">1 step</span><span class="badge badge-fast">10Ã— faster</span></td>
                                <td style="text-align: center;"><strong>1</strong></td>
                                <td><audio controls><source src="audio/stepflow_en_1.wav" type="audio/wav">Your browser does not support audio.</audio></td>
                                <td><audio controls><source src="audio/stepflow_zh_1.wav" type="audio/wav">Your browser does not support audio.</audio></td>
                            </tr>
                            <tr>
                                <td><span class="model-name">Naive Endpoint</span><span class="badge badge-fast">1 step</span></td>
                                <td style="text-align: center;">1</td>
                                <td><audio controls><source src="audio/baseline_en_1.wav" type="audio/wav">Your browser does not support audio.</audio></td>
                                <td><audio controls><source src="audio/baseline_zh_1.wav" type="audio/wav">Your browser does not support audio.</audio></td>
                            </tr>
                        </tbody>
                    </table>
                </div>


                <!-- CFG Ablation Study -->
                <div class="demo-section">
                    <h3>2. CFG Strength Ablation</h3>
                    <p style="margin-bottom: 20px;">Effect of classifier-free guidance (CFG) strength during inference. The student model achieves optimal performance at w=0.05, much lower than the teacher's w=0.7, because the student learns from teacher@w=0.7 targets during distillation and effectively internalizes the guidance effect.</p>
                    <table>
                        <thead>
                            <tr>
                                <th>CFG Strength (w)</th>
                                <th>Description</th>
                                <th>English Sample</th>
                                <th>Mandarin Sample</th>
                                <th>MOS-N</th>
                                <th>SIM-o</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="model-name">w = 0.00</span></td>
                                <td>No guidance</td>
                                <td><audio controls><source src="audio/cfg_w0.00_en.wav" type="audio/wav"></audio></td>
                                <td><audio controls><source src="audio/cfg_w0.00_zh.wav" type="audio/wav"></audio></td>
                                <td style="text-align: center;">4.29</td>
                                <td style="text-align: center;">65%</td>
                            </tr>
                            <tr class="stepflow-row">
                                <td><span class="model-name">w = 0.05</span><span class="badge badge-best">Optimal</span></td>
                                <td>Default (weak guidance)</td>
                                <td><audio controls><source src="audio/cfg_w0.05_en.wav" type="audio/wav"></audio></td>
                                <td><audio controls><source src="audio/cfg_w0.05_zh.wav" type="audio/wav"></audio></td>
                                <td style="text-align: center;"><strong class="best-score">4.32</strong></td>
                                <td style="text-align: center;"><strong class="best-score">66%</strong></td>
                            </tr>
                            <tr>
                                <td><span class="model-name">w = 0.10</span></td>
                                <td>Moderate guidance</td>
                                <td><audio controls><source src="audio/cfg_w0.10_en.wav" type="audio/wav"></audio></td>
                                <td><audio controls><source src="audio/cfg_w0.10_zh.wav" type="audio/wav"></audio></td>
                                <td style="text-align: center;">4.25</td>
                                <td style="text-align: center;">64%</td>
                            </tr>
                            <tr>
                                <td><span class="model-name">w = 0.20</span></td>
                                <td>Strong guidance</td>
                                <td><audio controls><source src="audio/cfg_w0.20_en.wav" type="audio/wav"></audio></td>
                                <td><audio controls><source src="audio/cfg_w0.20_zh.wav" type="audio/wav"></audio></td>
                                <td style="text-align: center;">4.10</td>
                                <td style="text-align: center;">59%</td>
                            </tr>
                            <tr>
                                <td><span class="model-name">w = 0.50</span></td>
                                <td>Very strong guidance</td>
                                <td><audio controls><source src="audio/cfg_w0.50_en.wav" type="audio/wav"></audio></td>
                                <td><audio controls><source src="audio/cfg_w0.50_zh.wav" type="audio/wav"></audio></td>
                                <td style="text-align: center;">3.78</td>
                                <td style="text-align: center;">55%</td>
                            </tr>
                        </tbody>
                    </table>
                    <div style="margin-top: 15px; font-size: 0.9em; color: #666;">
                        <strong>Note:</strong> The inverted CFG curve (optimal at w=0.05 vs teacher's w=0.7) occurs because distillation internalizes the teacher's guidance effect. Using stronger inference-time CFG conflicts with this internalized guidance, causing quality degradation.
                    </div>
                </div>

                <!-- Ablation Study -->
                <div class="demo-section">
                    <h3>3. Ablation Study: Component Analysis</h3>
                    <p style="margin-bottom: 20px;">Hear the contribution of each component in StepFlow.</p>
                    <table>
                        <thead>
                            <tr>
                                <th>Configuration</th>
                                <th>Components</th>
                                <th>English Sample</th>
                                <th>Mandarin Sample</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="model-name">Baseline</span></td>
                                <td>Endpoint only</td>
                                <td><audio controls><source src="audio/ablation_baseline_en.wav" type="audio/wav"></audio></td>
                                <td><audio controls><source src="audio/ablation_baseline_zh.wav" type="audio/wav"></audio></td>
                            </tr>
                            <tr>
                                <td><span class="model-name">+ Dual Supervision</span></td>
                                <td>Endpoint + Velocity</td>
                                <td><audio controls><source src="audio/ablation_dual_en.wav" type="audio/wav"></audio></td>
                                <td><audio controls><source src="audio/ablation_dual_zh.wav" type="audio/wav"></audio></td>
                            </tr>
                            <tr>
                                <td><span class="model-name">+ Step-Aware Arch</span></td>
                                <td>Step-aware tokens</td>
                                <td><audio controls><source src="audio/ablation_stepaware_en.wav" type="audio/wav"></audio></td>
                                <td><audio controls><source src="audio/ablation_stepaware_zh.wav" type="audio/wav"></audio></td>
                            </tr>
                            <tr class="stepflow-row">
                                <td><span class="model-name">StepFlow (Full)</span></td>
                                <td>All components</td>
                                <td><audio controls><source src="audio/stepflow_full_en.wav" type="audio/wav"></audio></td>
                                <td><audio controls><source src="audio/stepflow_full_zh.wav" type="audio/wav"></audio></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Main Results -->
            <section>
                <h2>Quantitative Results</h2>
                <p style="margin-bottom: 20px;">StepFlow outperforms existing distillation baselines while significantly improving inference efficiency.</p>
                <table class="metrics-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Steps</th>
                            <th>Parameters</th>
                            <th>MOS-N â†‘</th>
                            <th>SIM-O â†‘</th>
                            <th>RTF â†“</th>
                            <th>Speedup</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="model-name">Teacher (StepTTS)</span></td>
                            <td>10</td>
                            <td>154M</td>
                            <td>4.43 Â± 0.06</td>
                            <td>0.66</td>
                            <td>0.303</td>
                            <td>1Ã—</td>
                        </tr>
                        <tr>
                            <td><span class="model-name">Naive Endpoint</span></td>
                            <td>1</td>
                            <td>154M</td>
                            <td>3.87 Â± 0.08</td>
                            <td>0.61</td>
                            <td>0.031</td>
                            <td>9.8Ã—</td>
                        </tr>
                        <tr>
                            <td><span class="model-name">Progressive Distillation</span></td>
                            <td>1</td>
                            <td>154M</td>
                            <td>4.12 Â± 0.07</td>
                            <td>0.64</td>
                            <td>0.031</td>
                            <td>9.8Ã—</td>
                        </tr>
                        <tr class="stepflow-row">
                            <td><span class="model-name">StepFlow (Ours)</span></td>
                            <td><strong>1</strong></td>
                            <td><strong>118M (-24%)</strong></td>
                            <td><strong class="best-score">4.32 Â± 0.06</strong></td>
                            <td><strong class="best-score">0.66</strong></td>
                            <td><strong class="best-score">0.012</strong></td>
                            <td><strong class="best-score">25.3Ã—</strong></td>
                        </tr>
                    </tbody>
                </table>
                <div style="margin-top: 20px; font-size: 0.95em; color: #666;">
                    <strong>Notes:</strong> MOS-N = Mean Opinion Score for Naturalness (1-5 scale); SIM-O = Speaker Similarity to reference (0-1); RTF = Real-Time Factor (lower is faster); All models trained on 95K-hour Emilia dataset.
                </div>
            </section>

        </div>
    </div>
</body>
</html>
